#!/usr/bin/env python3
"""
STUN-based IPv6 NAT Detection
-----------------------------
Outputs the local vs public IPv6 address for NAT-aware AI or network tools.
"""

import socket
import stun  # pip install pystun3

def detect_ipv6_nat():
    try:
        # Create UDP IPv6 socket
        sock = socket.socket(socket.AF_INET6, socket.SOCK_DGRAM)
        sock.settimeout(3)

        # STUN server supporting IPv6 (Google STUN)
        stun_host = ("stun.l.google.com", 19302)

        nat_type, external_ip, external_port = stun.get_ip_info(stun_host[0], stun_host[1], sock)
        local_ip = sock.getsockname()[0]
        sock.close()

        if external_ip:
            print(f"üåê Public IPv6: {external_ip}")
            print(f"üè† Local  IPv6: {local_ip}")
        else:
            print("‚ö†Ô∏è Could not detect IPv6 public address. Check connectivity.")

    except Exception as e:
        print("‚ö†Ô∏è STUN IPv6 detection failed:", e)

if __name__ == "__main__":
    detect_ipv6_nat()
